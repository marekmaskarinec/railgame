agent.um
________________________________________________________________________________

________________________________________________________________________________


type PathFragment* = struct {
	pos: ^th.Vf2
	color: ^uint32
	occ: ^int
	occSw: ^int
	isSwitch: bool
}



________________________________________________________________________________


type Agent* = struct {
	length: int

	// max speed in coords per ms
	maxSpeed: th.fu
	// current speed in coords per ms
	speed: th.fu
	// acceleration per ms
	accel: th.fu
	// braking per ms
	braking: th.fu

	// path the agent goes through. nulls are switches
	path: []PathFragment

	// index on which the trains tail is
	tail: th.fu

	// agent state
	state: int

	color: uint32

	id: int
}



________________________________________________________________________________


fn (ag: ^Agent) init*()


________________________________________________________________________________


fn (ag: ^Agent) getBraking(): th.iu


________________________________________________________________________________


fn (ag: ^Agent) coordsAt(index: th.fu): th.Vf2


________________________________________________________________________________


fn (ag: ^Agent) sizeOf(index: th.fu): th.fu


________________________________________________________________________________


fn (ag: ^Agent) markSegs()


________________________________________________________________________________


fn (ag: ^Agent) done()


________________________________________________________________________________


fn (ag: ^Agent) move(delta: th.fu)


________________________________________________________________________________


fn (ag: ^Agent) setPath*(sys: ^rail.System, from, to: ^rail.Switch)


________________________________________________________________________________


fn (ag: ^Agent) reset*()


________________________________________________________________________________


fn (ag: ^Agent) draw()


________________________________________________________________________________


fn (ag: ^Agent) handle*(delta: th.fu)


________________________________________________________________________________


